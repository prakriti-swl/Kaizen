{% extends "base.html" %}
{% load static %}

{% block content %}

<section class="about-hero" style="background-image: url({% static 'img/background-img1.jpg' %});">
  <h2> Product Details </h2>
  <p>Know more about our products and their benefits.</p>
</section>

<section class="product-detail">
  <div class="container">

    <div style="margin: 25px 0;">
      <a href="{% url 'products' %}" class="btn btn-outline-secondary">
        &larr; Back to Products
      </a>
    </div>

    <div class="product-detail-container">

      <div class="product-detail-image">
        <img src="{{ product.image.url }}" alt="{{ product.name }}">
      </div>

      <div class="product-info-detail">
        <h2 class="product-detail-name">{{ product.name }}</h2>

        <div class="stars">
          {% for i in "12345" %}
            {% if forloop.counter <= product.average_rating %}‚òÖ{% else %}‚òÜ{% endif %}
          {% endfor %}
          <span>({{ product.reviews.count }} reviews)</span>
        </div>

        <div class="price-box">
          {% if product.sale_price %}
            <span class="original-price">${{ product.price }}</span>
            <span class="sale-price">${{ product.sale_price }}</span>
          {% else %}
            <span class="sale-price">${{ product.price }}</span>
          {% endif %}
        </div>

        <p class="description">
          {{ product.description|linebreaksbr }}
        </p>
      </div>
    </div>

    <div class="product-bottom-section">

      <!-- LEFT -->
      <div class="reviews-card" style="margin-top: 6px;">
        <h3>Reviews</h3>

        {% if user.is_authenticated %}
        <form method="POST" action="{% url 'submit_review' product.id %}">
          {% csrf_token %}

          <div class="star-rating">
            {% for i in "54321" %}
              <input type="radio" name="rating" value="{{ i }}" id="star{{ i }}">
              <label for="star{{ i }}">‚òÖ</label>
            {% endfor %}
          </div>

          <textarea
            name="comment"
            placeholder="Write your review here..."
            required style="width: 100%; border-radius: 5px; padding: 10px;"></textarea>

          <div class="form-submit">
            <button type="submit" class="btn">Send Review</button>
          </div>
        </form>
        {% endif %}

        <hr>

        {% for review in reviews %}
        <div class="review-item">
          <img src="{{ review.user.image.url }}">
          <div>
            <strong>{{ review.user.username }}</strong>
            <div class="stars">
              {% for i in "12345" %}
                {% if forloop.counter <= review.rating %}‚òÖ{% else %}‚òÜ{% endif %}
              {% endfor %}
            </div>
            <p>{{ review.message }}</p>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- RIGHT -->
      <div class="order-side-card" style="margin-bottom: 50px;">
        <h4>Ready to buy?</h4>
        <p>Hydrating overnight lip mask.</p>

        <a href="#" class="action-btn order-btn full">üõç Order Now</a>
        <a href="#" class="action-btn cart-btn full">üõí Add to Cart</a>
        <a href="#" class="action-btn wish-btn full">‚ù§ Wishlist</a>
      </div>

    </div>
  </div>
</section>

{% endblock %}
